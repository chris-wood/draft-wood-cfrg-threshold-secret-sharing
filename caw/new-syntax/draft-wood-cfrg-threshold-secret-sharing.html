<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Threshold Secret Sharing</title>
<meta content="Christopher A. Wood" name="author">
<meta content="
       This document specifies two variants of threshold secret sharing schemes.
The first variant, called unverifiable, is based on Shamir's original scheme,
and the second variant, called verifiable, is based on Feldman's scheme. 
    " name="description">
<meta content="xml2rfc 3.15.2" name="generator">
<meta content="threshold secret sharing" name="keyword">
<meta content="draft-wood-cfrg-threshold-secret-sharing-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.15.2
    Python 3.10.8
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.2
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.1
    MarkupSafe 2.1.1
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.4.0
    six 1.16.0
    wcwidth 0.2.5
-->
<link href="draft-wood-cfrg-threshold-secret-sharing.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl > dt {
  float: left;
  margin-right: 1em;
  min-width: 12ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
dl .break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href].selfRef {
  color: var(--text-color);
}
a[href] {
  color: var(--link-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: 14.5px;
}
.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 8em !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([stroke="fill"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Threshold Secret Sharing</td>
<td class="right">November 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Wood</td>
<td class="center">Expires 1 June 2023</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Crypto Forum</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-wood-cfrg-threshold-secret-sharing-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-11-28" class="published">28 November 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2023-06-01">1 June 2023</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">C. A. Wood</div>
<div class="org">Cloudflare</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Threshold Secret Sharing</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies two variants of threshold secret sharing schemes.
The first variant, called unverifiable, is based on Shamir's original scheme,
and the second variant, called verifiable, is based on Feldman's scheme.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://chris-wood.github.io/draft-wood-cfrg-threshold-secret-sharing/draft-wood-cfrg-threshold-secret-sharing.html">https://chris-wood.github.io/draft-wood-cfrg-threshold-secret-sharing/draft-wood-cfrg-threshold-secret-sharing.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-wood-cfrg-threshold-secret-sharing/">https://datatracker.ietf.org/doc/draft-wood-cfrg-threshold-secret-sharing/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Crypto Forum Research Group mailing list (<span><a href="mailto:cfrg@ietf.org">mailto:cfrg@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/search/?email_list=cfrg">https://mailarchive.ietf.org/arch/search/?email_list=cfrg</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/cfrg/">https://www.ietf.org/mailman/listinfo/cfrg/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/chris-wood/draft-wood-cfrg-threshold-secret-sharing">https://github.com/chris-wood/draft-wood-cfrg-threshold-secret-sharing</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 1 June 2023.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-cryptographic-dependencies" class="internal xref">Cryptographic Dependencies</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-finite-field" class="internal xref">Finite Field</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1" class="keepWithNext"><a href="#section-3.1.1" class="auto internal xref">3.1.1</a>.  <a href="#name-field-f64" class="internal xref">Field F64</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="auto internal xref">3.1.2</a>.  <a href="#name-field-f128" class="internal xref">Field F128</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.3">
                    <p id="section-toc.1-1.3.2.1.2.3.1"><a href="#section-3.1.3" class="auto internal xref">3.1.3</a>.  <a href="#name-field-f255" class="internal xref">Field F255</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.4">
                    <p id="section-toc.1-1.3.2.1.2.4.1"><a href="#section-3.1.4" class="auto internal xref">3.1.4</a>.  <a href="#name-field-fcurve25519" class="internal xref">Field FCurve25519</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-prime-order-group" class="internal xref">Prime-Order Group</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="auto internal xref">3.2.1</a>.  <a href="#name-group-ristretto255" class="internal xref">Group Ristretto255</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-helper-functions" class="internal xref">Helper Functions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-polynomial-coefficient-deri" class="internal xref">Polynomial coefficient derivation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-evaluation-of-a-polynomial" class="internal xref">Evaluation of a polynomial</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-lagrange-coefficients" class="internal xref">Lagrange coefficients</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-secret-sharing-schemes" class="internal xref">Secret Sharing Schemes</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-splitter-functions" class="internal xref">Splitter Functions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-recovery-functions" class="internal xref">Recovery Functions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-secret-sharing-variants" class="internal xref">Secret Sharing Variants</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-basic-threshold-secret-shar" class="internal xref">Basic Threshold Secret Sharing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-authenticated-threshold-sec" class="internal xref">Authenticated Threshold Secret Sharing with Random Tags</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-authenticated-threshold-secr" class="internal xref">Authenticated Threshold Secret Sharing with Deterministic Tags</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-random-scalar-generation" class="internal xref">Random Scalar Generation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-rejection-sampling" class="internal xref">Rejection Sampling</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-wide-reduction" class="internal xref">Wide Reduction</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-test-vectors" class="internal xref">Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-tss-f64" class="internal xref">TSS-F64</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-tss-f128" class="internal xref">TSS-F128</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#appendix-A.3" class="auto internal xref">A.3</a>.  <a href="#name-tss-f255" class="internal xref">TSS-F255</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a href="#appendix-A.4" class="auto internal xref">A.4</a>.  <a href="#name-dvtss-ristretto255" class="internal xref">DVTSS-Ristretto255</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.5">
                <p id="section-toc.1-1.11.2.5.1"><a href="#appendix-A.5" class="auto internal xref">A.5</a>.  <a href="#name-rvtss-ristretto255" class="internal xref">RVTSS-Ristretto255</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Threshold secret sharing is a well-known and widely used cryptographic
algorithm that has a number of applications, ranging from distributed
key generation, threshold digital signatures, and privacy-preserving
measurement. Threshold secret sharing allows the owner of a secret
to split it into independent shares, each of which reveals nothing about
the secret on its own. However, the threshold number of shares for a secret
can be efficiently recombined by an aggregator to recover a shared secret.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The original threshold secret sharing scheme is due to Shamir <span>[<a href="#ShamirSecretSharing" class="cite xref">ShamirSecretSharing</a>]</span>.
However, many variations exist with different properties. For example, some
secret sharing schemes can be verifiable <span>[<a href="#Feldman" class="cite xref">Feldman</a>]</span>, which allows an aggregator to check
that the share is valid. Other schemes allow metadata to be associated with
a secret share and authenticated during secret recovery <span>[<a href="#ADSS" class="cite xref">ADSS</a>]</span>.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This document specifies a simple abstraction for threshold secret sharing
with two different modes: unverifiable and verifiable. We denote TSS and VTSS
as the unverifiable and verifiable modes, respectively.<a href="#section-1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">The following notation is used throughout the document.<a href="#section-2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-3.1">
          <code>random_bytes(n)</code>: Outputs <code>n</code> bytes, sampled uniformly at random
using a cryptographically secure pseudorandom number generator (CSPRNG).<a href="#section-2-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.2">
          <code>len(l)</code>: Outputs the length of input list <code>l</code>, e.g., <code>len([1,2,3]) = 3)</code>.<a href="#section-2-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.3">
          <code>range(a, b)</code>: Outputs a list of integers from <code>a</code> to <code>b-1</code> in ascending order, e.g., <code>range(1, 4) = [1,2,3]</code>.<a href="#section-2-3.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.4">
          <code>pow(a, b)</code>: Outputs the integer result of <code>a</code> to the power of <code>b</code>, e.g., <code>pow(2, 3) = 8</code>.<a href="#section-2-3.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.5">
          <code>str(x)</code>: Outputs an ASCII string encoding of the integer input <code>x</code>, e.g., <code>str(1) = "1"</code>.<a href="#section-2-3.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.6">|| denotes concatenation of byte strings, i.e., <code>x || y</code> denotes the byte string <code>x</code>, immediately followed by
the byte string <code>y</code>, with no extra separator, yielding <code>xy</code>.<a href="#section-2-3.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.7">nil denotes an empty byte string.<a href="#section-2-3.7" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-2-4">Unless otherwise stated, we assume that secrets are sampled uniformly at random
using a cryptographically secure pseudorandom number generator (CSPRNG); see
<span>[<a href="#RFC4086" class="cite xref">RFC4086</a>]</span> for additional guidance on the generation of random numbers.<a href="#section-2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cryptographic-dependencies">
<section id="section-3">
      <h2 id="name-cryptographic-dependencies">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-cryptographic-dependencies" class="section-name selfRef">Cryptographic Dependencies</a>
      </h2>
<p id="section-3-1">Threshold secret sharing signing depends on the following cryptographic constructs:<a href="#section-3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-2.1">Finite Field, <a href="#dep-field" class="auto internal xref">Section 3.1</a>;<a href="#section-3-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.2">Prime-Order Group, <a href="#dep-pog" class="auto internal xref">Section 3.2</a>;<a href="#section-3-2.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-3-3">These are described in the following sections.<a href="#section-3-3" class="pilcrow">¶</a></p>
<div id="dep-field">
<section id="section-3.1">
        <h3 id="name-finite-field">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-finite-field" class="section-name selfRef">Finite Field</a>
        </h3>
<p id="section-3.1-1">A finite field <code>F</code> is a field of finite size, where the size is referred to as the order.
We refer to an element of the field as a Scalar. As a field, each Scalar supports normal
arithmetic operations, including multiplication, addition, subtraction, and division. Finite
fields are commonly implemented over the integers modulo a prime p, defined as the <code>MODULUS</code>.
Each field also has an associated parameter called <code>SCALAR_SIZE</code>, which is the number of
bytes used to encode a field element as a byte string.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">For convenience, each field has an associated function called <code>RandomScalar</code> that
is used to sample a uniformly random Scalar from the field. Refer to <a href="#random-scalar" class="auto internal xref">Section 7</a>
for implementation guidance.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">Each field <code>F</code> also has the following encoding and decoding functions:<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-4.1">HashToScalar(x, ctx): Deterministically maps input <code>x</code> to a Scalar element using the domain
separation tag <code>ctx</code>.<a href="#section-3.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-4.2">SerializeScalar(s): Maps a Scalar <code>s</code> to a canonical byte array <code>buf</code> of fixed length <code>SCALAR_SIZE</code>.<a href="#section-3.1-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-4.3">DeserializeScalar(buf): Attempts to map a byte array <code>buf</code> to a <code>Scalar</code> <code>s</code>.
This function can raise an error if deserialization fails.<a href="#section-3.1-4.3" class="pilcrow">¶</a>
</li>
        </ul>
<div id="field-f64">
<section id="section-3.1.1">
          <h4 id="name-field-f64">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-field-f64" class="section-name selfRef">Field F64</a>
          </h4>
<p id="section-3.1.1-1">This named field uses MODULUS=2^32 * 4294967295 + 1 with SCALAR_SIZE=8. The implementation of
the field functions defined in <a href="#dep-field" class="auto internal xref">Section 3.1</a> is as follows.<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.1-2.1">HashToScalar(x, ctx): Implemented as hash_to_field(m, 1) from <span>[<a href="#HASH-TO-CURVE" class="cite xref">HASH-TO-CURVE</a>], <a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-16#section-5.2" class="relref">Section 5.2</a></span>
using <code>expand_message_xmd</code> with SHA-256 with parameters DST = "F128" || ctx,
F set to the scalar field, p set to <code>MODULUS</code>, m = 1, and L = TBD.<a href="#section-3.1.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.1.1-2.2">SerializeScalar(s): Implemented by outputting the big-endian 8-byte encoding of
the Scalar value.<a href="#section-3.1.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.1.1-2.3">DeserializeScalar(buf): Implemented by attempting to deserialize a Scalar from a
big-endian 8-byte string. This function can fail if the input does not
represent a Scalar in the range [0, MODULUS - 1].<a href="#section-3.1.1-2.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="field-f128">
<section id="section-3.1.2">
          <h4 id="name-field-f128">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-field-f128" class="section-name selfRef">Field F128</a>
          </h4>
<p id="section-3.1.2-1">This named field uses MODULUS=2^66 * 4611686018427387897 + 1 with SCALAR_SIZE=16. The implementation of
the field functions defined in <a href="#dep-field" class="auto internal xref">Section 3.1</a> is as follows.<a href="#section-3.1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.2-2.1">HashToScalar(x, ctx): Implemented as hash_to_field(m, 1) from <span>[<a href="#HASH-TO-CURVE" class="cite xref">HASH-TO-CURVE</a>], <a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-16#section-5.2" class="relref">Section 5.2</a></span>
using <code>expand_message_xmd</code> with SHA-256 with parameters DST = "F128" || ctx,
F set to the scalar field, p set to <code>MODULUS</code>, m = 1, and L = TBD.<a href="#section-3.1.2-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.1.2-2.2">SerializeScalar(s): Implemented by outputting the big-endian 16-byte encoding of
the Scalar value.<a href="#section-3.1.2-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.1.2-2.3">DeserializeScalar(buf): Implemented by attempting to deserialize a Scalar from a
big-endian 16-byte string. This function can fail if the input does not
represent a Scalar in the range [0, MODULUS - 1].<a href="#section-3.1.2-2.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="field-f255">
<section id="section-3.1.3">
          <h4 id="name-field-f255">
<a href="#section-3.1.3" class="section-number selfRef">3.1.3. </a><a href="#name-field-f255" class="section-name selfRef">Field F255</a>
          </h4>
<p id="section-3.1.3-1">This named field uses MODULUS=2^255 - 19 with SCALAR_SIZE=32. The implementation of
the field functions defined in <a href="#dep-field" class="auto internal xref">Section 3.1</a> is as follows.<a href="#section-3.1.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.3-2.1">HashToScalar(x, ctx): Implemented by computing SHA-512("F255" || DST || x) and mapping the
output to a Scalar as described in <span>[<a href="#RISTRETTO" class="cite xref">RISTRETTO</a>], <a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-ristretto255-decaf448-04#section-4.4" class="relref">Section 4.4</a></span>.<a href="#section-3.1.3-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.1.3-2.2">SerializeScalar(s): Implemented by outputting the little-endian 32-byte encoding of
the Scalar value with the top three bits set to zero.<a href="#section-3.1.3-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.1.3-2.3">DeserializeScalar(buf): Implemented by attempting to deserialize a Scalar from a
little-endian 32-byte string. This function can fail if the input does not
represent a Scalar in the range [0, <code>G.Order()</code> - 1]. Note that this means the
top three bits of the input <span class="bcp14">MUST</span> be zero.<a href="#section-3.1.3-2.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="field-fcurve25519">
<section id="section-3.1.4">
          <h4 id="name-field-fcurve25519">
<a href="#section-3.1.4" class="section-number selfRef">3.1.4. </a><a href="#name-field-fcurve25519" class="section-name selfRef">Field FCurve25519</a>
          </h4>
<p id="section-3.1.4-1">This named field uses MODULUS=2^252 + 0x14def9dea2f79cd65812631a5cf5d3ed with SCALAR_SIZE=32.
It is the scalar field for the Curve25519 elliptic curve. The implementation of
the field functions defined in <a href="#dep-field" class="auto internal xref">Section 3.1</a> is as follows.<a href="#section-3.1.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.4-2.1">HashToScalar(x, ctx): Implemented by computing SHA-512("FCurve25519" || DST || x) and mapping the
output to a Scalar as described in <span>[<a href="#RISTRETTO" class="cite xref">RISTRETTO</a>], <a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-ristretto255-decaf448-04#section-4.4" class="relref">Section 4.4</a></span>.<a href="#section-3.1.4-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.1.4-2.2">SerializeScalar(s): Implemented by outputting the little-endian 32-byte encoding of
the Scalar value with the top three bits set to zero.<a href="#section-3.1.4-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.1.4-2.3">DeserializeScalar(buf): Implemented by attempting to deserialize a Scalar from a
little-endian 32-byte string. This function can fail if the input does not
represent a Scalar in the range [0, <code>G.Order()</code> - 1]. Note that this means the
top three bits of the input <span class="bcp14">MUST</span> be zero.<a href="#section-3.1.4-2.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="dep-pog">
<section id="section-3.2">
        <h3 id="name-prime-order-group">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-prime-order-group" class="section-name selfRef">Prime-Order Group</a>
        </h3>
<p id="section-3.2-1">A prime-order group <code>G</code> is an an abelian group of prime order <code>p</code>, denoted <code>ORDER</code>. Integers, taken modulo
the group order <code>p</code>, form a finite field of order p.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">The group operation for <code>G</code> is addition <code>+</code> with identity element <code>I</code>. For any elements
<code>A</code> and <code>B</code> of the group <code>G</code>, <code>A + B = B + A</code> is also a member of <code>G</code>. Also, for any
<code>A</code> in <code>G</code>, there exists an element <code>-A</code> such that <code>A + (-A) = (-A) + A = I</code>. For
convenience, we use <code>-</code> to denote subtraction, e.g., <code>A - B = A + (-B)</code>.
We denote equality comparison as <code>==</code> and assignment of values by <code>=</code>.
It is assumed that group element addition, negation, and equality comparisons can be
efficiently computed for arbitrary group elements.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">Scalar multiplication is equivalent to the repeated application of the group operation on
an element <code>A</code> with itself <code>r-1</code> times, denoted as <code>ScalarMult(A, r)</code>. For any element <code>A</code>, <code>ScalarMult(A, p) = I</code>.
We denote <code>B</code> as a fixed generator of the group. Scalar base multiplication is equivalent to the repeated application
of the group operation <code>B</code> with itself <code>r-1</code> times, this is denoted as <code>ScalarBaseMult(r)</code>.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">This document uses the <code>Element</code> type to denote elements of the group <code>G</code>, and <code>Scalar</code> type to
represent elements of the corresponding finite field. We denote Scalar(x) as the conversion
of integer input <code>x</code> to the corresponding Scalar value with the same numeric value. For example,
Scalar(1) yields a Scalar representing the value 1.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2-5">We now detail a number of member functions that can be invoked on <code>G</code>.<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-6.1">Identity(): Outputs the identity <code>Element</code> of the group (i.e. <code>I</code>).<a href="#section-3.2-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-6.2">ScalarMult(A, k): Output the scalar multiplication between Element <code>A</code> and Scalar <code>k</code>.<a href="#section-3.2-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-6.3">ScalarBaseMult(k): Output the scalar multiplication between Scalar <code>k</code> and the group generator <code>B</code>.<a href="#section-3.2-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-6.4">SerializeElement(A): Maps an <code>Element</code> <code>A</code> to a canonical byte array <code>buf</code> of fixed length <code>Nelement</code>. This
function can raise an error if <code>A</code> is the identity element of the group.<a href="#section-3.2-6.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-6.5">DeserializeElement(buf): Attempts to map a byte array <code>buf</code> to an <code>Element</code> <code>A</code>,
and fails if the input is not the valid canonical byte representation of an element of
the group. This function can raise an error if deserialization fails
or <code>A</code> is the identity element of the group.<a href="#section-3.2-6.5" class="pilcrow">¶</a>
</li>
        </ul>
<div id="group-ristretto255">
<section id="section-3.2.1">
          <h4 id="name-group-ristretto255">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-group-ristretto255" class="section-name selfRef">Group Ristretto255</a>
          </h4>
<p id="section-3.2.1-1">This named group has prime order 2^252 + 27742317777372353535851937790883648493 (see <span>[<a href="#RISTRETTO" class="cite xref">RISTRETTO</a>]</span>), using
FCurve25519 as the underlying scalar finite field. The implementation of the group functions defined
in <a href="#dep-pog" class="auto internal xref">Section 3.2</a> is as follows.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1-2.1">Identity(): As defined in <span>[<a href="#RISTRETTO" class="cite xref">RISTRETTO</a>]</span>.<a href="#section-3.2.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.2.1-2.2">SerializeElement(A): Implemented using the 'Encode' function from <span>[<a href="#RISTRETTO" class="cite xref">RISTRETTO</a>]</span>.
Additionally, this function validates that the input element is not the group
identity element.<a href="#section-3.2.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.2.1-2.3">DeserializeElement(buf): Implemented using the 'Decode' function from <span>[<a href="#RISTRETTO" class="cite xref">RISTRETTO</a>]</span>.
Additionally, this function validates that the resulting element is not the group
identity element.<a href="#section-3.2.1-2.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="helpers">
<section id="section-4">
      <h2 id="name-helper-functions">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-helper-functions" class="section-name selfRef">Helper Functions</a>
      </h2>
<p id="section-4-1">This section describes operations on and associated with polynomials over Scalars
that are used for secret sharing. A polynomial of maximum degree t+1 is represented
as a list of t coefficients, where the constant term of the polynomial
is in the first position and the highest-degree coefficient is in the last position.
A point on the polynomial is a tuple (x, y), where <code>y = f(x)</code>. For notational
convenience, we refer to the x-coordinate and y-coordinate of a
point p as <code>p.x</code> and <code>p.y</code>, respectively.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="polynomial-coefficient-derivation">
<section id="section-4.1">
        <h3 id="name-polynomial-coefficient-deri">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-polynomial-coefficient-deri" class="section-name selfRef">Polynomial coefficient derivation</a>
        </h3>
<p id="section-4.1-1">This section describes a method for deriving a polynomial coefficients based on a secret value
and randomness as input. The function is implicitly parameterized by a field F.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-2">
<pre>
  derive_poylnomial_coefficients(zero_coefficient, coefficient_rand, threshold, ctx):

  Inputs:
  - zero_coefficient, secret value for the 0-th coefficient
  - coefficient_rand, randomness for deriving the remaining coefficients
  - threshold, the number of coefficients to derive
  - ctx, a one-byte context identifier for the polynomial

  Outputs:
  - base, the encoded secret associated with the polynomial
  - poly, a list of coefficients representing the polynomial, starting from 0 in increasing order

  def derive_poylnomial_coefficients(zero_coefficient, coefficient_rand, t):
    base = F.HashToScalar(zero_coefficient, ctx || "-" || str(t) || "-" || str(0))
    poly = [base]
    for i in range(1, t):
      poly.extend(F.HashToScalar(rand, ctx || "-" || str(t) || "-" || str(i)))
    return F.SerialieScalar(base), poly
</pre><a href="#section-4.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="evaluation-of-a-polynomial">
<section id="section-4.2">
        <h3 id="name-evaluation-of-a-polynomial">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-evaluation-of-a-polynomial" class="section-name selfRef">Evaluation of a polynomial</a>
        </h3>
<p id="section-4.2-1">This section describes a method for evaluating a polynomial <code>f</code> at a
particular input <code>x</code>, i.e., <code>y = f(x)</code> using Horner's method.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-2">
<pre>
  polynomial_evaluate(x, coeffs):

  Inputs:
  - x, input at which to evaluate the polynomial, a Scalar
  - coeffs, the polynomial coefficients, a list of Scalars

  Outputs: Scalar result of the polynomial evaluated at input x

  def polynomial_evaluate(x, coeffs):
    value = 0
    for coeff in reverse(coeffs):
      value *= x
      value += coeff
    return value
</pre><a href="#section-4.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="lagrange-coefficients">
<section id="section-4.3">
        <h3 id="name-lagrange-coefficients">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-lagrange-coefficients" class="section-name selfRef">Lagrange coefficients</a>
        </h3>
<p id="section-4.3-1">The function <code>derive_lagrange_coefficient</code> derives a Lagrange coefficient
to later perform polynomial interpolation, and is provided a list of x-coordinates
as input. Note that <code>derive_lagrange_coefficient</code> does not permit any x-coordinate
to equal 0. Lagrange coefficients are used in FROST to evaluate a polynomial <code>f</code>
at x-coordinate 0, i.e., <code>f(0)</code>, given a list of <code>t</code> other x-coordinates.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-2">
<pre>
  derive_lagrange_coefficient(x_i, L):

  Inputs:
  - x_i, an x-coordinate contained in L, a Scalar
  - L, the set of x-coordinates, each a Scalar

  Outputs: L_i, the i-th Lagrange coefficient

  Errors:
  - "invalid parameters", if 1) any x-coordinate is equal to 0, 2) if x_i
    is not in L, or if 3) any x-coordinate is represented more than once in L.

  def derive_lagrange_coefficient(x_i, L):
    if x_i == 0:
      raise "invalid parameters"
    for x_j in L:
      if x_j == 0:
        raise "invalid parameters"
    if x_i not in L:
      raise "invalid parameters"
    for x_j in L:
      if count(x_j, L) &gt; 1:
        raise "invalid parameters"

    numerator = Scalar(1)
    denominator = Scalar(1)
    for x_j in L:
      if x_j == x_i: continue
      numerator *= x_j
      denominator *= x_j - x_i

    L_i = numerator / denominator
    return L_i
</pre><a href="#section-4.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="secret-sharing-schemes">
<section id="section-5">
      <h2 id="name-secret-sharing-schemes">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-secret-sharing-schemes" class="section-name selfRef">Secret Sharing Schemes</a>
      </h2>
<p id="section-5-1">In this section we describe different variants of secret sharing scheme. Each scheme
consists of two phases: secret splitting, run by clients, and secret recovery, run
by aggregators. Secret splitting takes as input a secret, randomness, and a threshold,
and uses it to produce a shared secret and one or more shares that can be combined
to recover the shared secret. The splitting phase is shown below.<a href="#section-5-1" class="pilcrow">¶</a></p>
<span id="name-secret-splitting-procedure"></span><div id="split-procedure">
<figure id="figure-1">
        <div class="alignLeft art-text artwork" id="section-5-2.1">
<pre>
             +---------+
   Secret ---&gt; Secret  +-----&gt; Share 1, Share 2, ...
Randomness --&gt;  Split  +-----&gt; Shared secret
             +---------+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-secret-splitting-procedure" class="selfRef">Secret splitting procedure</a>
        </figcaption></figure>
</div>
<p id="section-5-3">Secret recovery involves the combination of at least the threshold number of secret shares
to produce the shared secret derived from the splitting phase. This is shown below.<a href="#section-5-3" class="pilcrow">¶</a></p>
<span id="name-secret-recover-procedure"></span><div id="recover-procedure">
<figure id="figure-2">
        <div class="alignLeft art-text artwork" id="section-5-4.1">
<pre>
Share 1   Share 2   ..   Share t
    |          |             |
    |          |             |    +-----------+
    |          |             +---&gt;|  Secret   |
    |          +-----------------&gt;|  Recover  +--&gt; Shared Secret
    +----------------------------&gt;+-----------+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-secret-recover-procedure" class="selfRef">Secret recover procedure</a>
        </figcaption></figure>
</div>
<p id="section-5-5">Each scheme follows the same two-step pattern on the client for the splitting phase:<a href="#section-5-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5-6">
<li id="section-5-6.1">Set up a secret sharing context on the client.<a href="#section-5-6.1" class="pilcrow">¶</a>
</li>
        <li id="section-5-6.2">Use the context to produce one or more shares.<a href="#section-5-6.2" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-5-7">The aggregator then runs a recovery function in the recovery phase to combine
some threshold number of shares to produce the shared secret.<a href="#section-5-7" class="pilcrow">¶</a></p>
<p id="section-5-8">Beyond the basic scheme, there are secret sharing schemes that provide authenticated
shares, i.e., shares that can be verified for correctness by the aggregator prior to
aggregating. Each variant is identified by a one-byte value.<a href="#section-5-8" class="pilcrow">¶</a></p>
<span id="name-secret-sharing-schemes-2"></span><div id="hpke-modes">
<table class="center" id="table-1">
        <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-secret-sharing-schemes-2" class="selfRef">Secret sharing schemes</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Mode</th>
            <th class="text-left" rowspan="1" colspan="1">Value</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">mode_basic</td>
            <td class="text-left" rowspan="1" colspan="1">0x00</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">mode_auth_deterministic</td>
            <td class="text-left" rowspan="1" colspan="1">0x01</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">mode_auth_random</td>
            <td class="text-left" rowspan="1" colspan="1">0x02</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-5-10">The rest of this section describes some core funtions used by the secret sharing
schemes. Each of the variants are then described in <a href="#variants" class="auto internal xref">Section 6</a>.<a href="#section-5-10" class="pilcrow">¶</a></p>
<div id="splitter-functions">
<section id="section-5.1">
        <h3 id="name-splitter-functions">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-splitter-functions" class="section-name selfRef">Splitter Functions</a>
        </h3>
<p id="section-5.1-1">The splitting phase requries establishment of a context. This context takes
as input the secret value <code>secret</code> to share, the randomness <code>rand</code> to use
for deriving shares, and the desired threshold of the shares. The context
then consists of the internal poylnomial used for producing shares, as well
as the shared secret associated with each share.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">Construction of the context is done as follows:<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1-3">
<pre>
def SetupSplitter(mode, threshold, secret, rand):
  shared_secret, poly = derive_poylnomial_coefficients(secret, rand, threshold, mode)
  return SplitterContext(mode, threshold, shared_secret, poly)
</pre><a href="#section-5.1-3" class="pilcrow">¶</a>
</div>
<p id="section-5.1-4">The splitter context can then be used to produce shares evaluated at specific points
on the polynomial. In particular, the context has a function for evaluating the
secret sharing polynomial on the input Scalar <code>id</code> and producing the corresponding output.
This function is implemented as follows<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1-5">
<pre>
def Context.Split(id):
  value = polynomial_evaluate(id, self.poly)
  return value
</pre><a href="#section-5.1-5" class="pilcrow">¶</a>
</div>
<p id="section-5.1-6">For authenticated variants, the splitter context can also be used to produce commitments
to the underlying secret. This document defines two types of commitments: random and deterministic
commitments. Each of these functions takes as input an identifier at which the secret sharing
polynomial was evaluated, as well as its evalutiation output, and produces a unique data
structure for the type of commitment.<a href="#section-5.1-6" class="pilcrow">¶</a></p>
<p id="section-5.1-7">These two functions are implemented as follows.<a href="#section-5.1-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1-8">
<pre>
def Context.RandomCommitment(id, value):
  random_secret = G.RandomScalar()
  random_seed = random(32)

  inner_splitter = SetupSplitter(self.mode, self.threshold, random_secret, random_seed)
  value = inner_splitter.Split(id)

  random_commitment = []
  for coefficient in inner_splitter.poly:
    C_i = G.ScalarBaseMult(coefficient)
    random_commitment.append(C_i)
  return (random_value, random_commitment)

def Context.DeterministicCommitment(id, value):
  commitment = []
  for coefficient in self.poly:
    C_i = G.ScalarBaseMult(coefficient)
    commitment.append(C_i)
  return commitment
</pre><a href="#section-5.1-8" class="pilcrow">¶</a>
</div>
<p id="section-5.1-9">Commitments can be serialized and deserialized from their unique data structures to
byte strings using for transmission between clients and aggregators. The following two
functions describe how to serialize and deserialize deterministic commitments. Note that
the deserialization function is fallible for invalid inputs, i.e., inputs of the wrong
length or with invalid Element encodings.<a href="#section-5.1-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1-10">
<pre>
SerializeDeterministicCommitment(commitment):
  commitment = nil
  for C_i in commitment:
    commitment = commitment || G.SerializeElement(C_i)
  return commitment

DeserializeDeterministicCommitment(commitment):
  if len(commitment) % Nelement != 0:
    raise "invalid input"
  num_coefficients = len(commitment) % Nelement
  commitments = []
  for i in range(0, num_coefficients):
    c_i = G.DeserializeElement(commitment[i*Nelement:(i+1)*Nelement])
    commitments.extend(c_i)
  return commitments
</pre><a href="#section-5.1-10" class="pilcrow">¶</a>
</div>
<p id="section-5.1-11">Similarly, the following two functions describe how to serialize and deserialize random
commitments. Note that the deserialization function is fallible for invalid inputs, i.e.,
inputs of the wrong length or with invalid Element encodings.<a href="#section-5.1-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1-12">
<pre>
SerializeRandomCommitment(commitment):
  random_value, random_commitments = commitment
  commitment = F.SerializeScalar(random_value)
  for C_i in random_commitments:
    commitment = commitment || G.SerializeElement(C_i)
  return commitment

DeserializeRandomCommitment(commitment):
  if len(commitment) &lt; Nscalar:
    raise "invalid input"
  random_value = F.DeserializeScalar(commitment[:Nscalar])

  if len(commitment[Nscalar:]) % Nelement != 0:
  num_coefficients = len(commitment[Nscalar:]) % Nelement
  random_commitments = []
  for i in range(0, num_coefficients):
    c_i = G.DeserializeElement(commitment[Nscalar+i*Nelement:Nscalar+(i+1)*Nelement])
    random_commitments.extend(c_i)
  return (random_value, random_commitments)
</pre><a href="#section-5.1-12" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="recovery-functions">
<section id="section-5.2">
        <h3 id="name-recovery-functions">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-recovery-functions" class="section-name selfRef">Recovery Functions</a>
        </h3>
<p id="section-5.2-1">The basic recovery phase consists of a single function:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-2.1">Combine(k, share_set): Aggregate the secret shares in <code>share_set</code>, which is of size at least
<code>k</code>, and recover the shared secret output from the corresponding RandomShare or Share function.
If recovery fails, this function returns an error.<a href="#section-5.2-2.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.2-3">This function is implemented as follows.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-4">
<pre>
def Combine(threshold, points):
  if points.length &lt; threshold:
    raise RecoveryFailedError

  poly = polynomial_interpolation(points)
  shared_secret = F.SerializeScalar(poly[0])
  return shared_secret
</pre><a href="#section-5.2-4" class="pilcrow">¶</a>
</div>
<p id="section-5.2-5">For authenticated variants, the recovery phase also requires verifying random or deterministic
share commitments produced during the splitting phase. Verification is done using one of
the two following functions.<a href="#section-5.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-6">
<pre>
def VerifyRandomCommitment(id, value, commitment):
  random_value, random_commitments = commitment
  S' = G.ScalarBaseMult(value) + G.ScalarBaseMult2(random_value)
  S = G.Identity()
  for C_i in random_commitments:
    S = S + G.ScalarMult(C_i, pow(id, j))
  return S == S'

def VerifyDeterministicCommitment(id, value, commitment):
  S' = G.ScalarBaseMult(value)
  S = G.Identity()
  for C_i in commitment:
    S = S + G.ScalarMult(C_i, pow(id, j))
  return S == S'
</pre><a href="#section-5.2-6" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="variants">
<section id="section-6">
      <h2 id="name-secret-sharing-variants">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-secret-sharing-variants" class="section-name selfRef">Secret Sharing Variants</a>
      </h2>
<p id="section-6-1">This section describes the secret sharing variants. Each scheme has the basic syntax:<a href="#section-6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-2.1">Share(k, secret, rand, n): Produce <code>n</code> <code>k</code>-threshold shares of <code>secret</code> using randomness <code>rand</code> for the
target Scalar x, as well as an encoding of the shared secret. The value <code>k</code> is an integer, <code>secret</code>
and <code>rand</code> are byte strings, <code>x</code> is a Scalar, and <code>n</code> is a positive integer at least as large as <code>k</code>.
The output is a list of <code>n</code> byte strings.<a href="#section-6-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-2.2">RandomShare(k, secret, rand): Produce a random <code>k</code>-threshold share of <code>secret</code> using randomness <code>rand</code>,
as well as an encoding of the shared secret. The share is a <code>Nshare</code>-byte string, and the shared
secret is a <code>Nsecret</code>-byte string. The value <code>k</code> is an integer, and <code>secret</code>  and <code>rand</code> are byte strings.<a href="#section-6-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-2.3">Recover(k, share_set): Combine the secret shares in <code>share_set</code>, which is of size at least
<code>k</code>, and recover the shared secret output from the corresponding RandomShare or Share function.
If recovery fails, this function returns an error.<a href="#section-6-2.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-6-3">The authenticated variants extend this syntax with two new functions:<a href="#section-6-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-4.1">Verify(share): Output 1 if <code>share</code> is valid and 0 otherwise, where <code>share</code> is a byte string
output from Share or RandomShare.<a href="#section-6-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-4.2">ShareCommitment(share): Outputs a byte-string <code>commitment</code> corresponding to the share, where <code>share</code>
is a byte string output from Share or RandomShare.<a href="#section-6-4.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-6-5">The rest of this section describes the different secret sharing variants.<a href="#section-6-5" class="pilcrow">¶</a></p>
<div id="tss">
<section id="section-6.1">
        <h3 id="name-basic-threshold-secret-shar">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-basic-threshold-secret-shar" class="section-name selfRef">Basic Threshold Secret Sharing</a>
        </h3>
<p id="section-6.1-1">The basic threshold secret sharing scheme, denoted TSS, is parameterzed by a field F
that implements the abstraction described in <a href="#dep-field" class="auto internal xref">Section 3.1</a>. Using F, the RandomShare,
Share, and Recover functions are implemented as follows.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1-2">
<pre>
def Share(threshold, secret, rand, id):
  context = SetupSplitter(mode_basic, secret, rand, threshold)

  value = context.Split(id)

  # Serialize the share
  id_enc = G.SerializeScalar(id)
  value_enc = G.SerializeScalar(value)
  share = id_enc || value_enc

  return context.shared_secret, share

def RandomShare(k, secret, rand):
  x = F.RandomScalar()
  return Share(k, secret, rand, x)

def Recover(threshold, share_set):
  if share_set.length &lt; threshold:
    raise RecoveryFailedError

  points = []
  for share in share_set:
    x = F.DeserializeScalar(share[0:SCALAR_SIZE])
    y = F.DeserializeScalar(share[SCALAR_SIZE:])
    points.append((x, y))

  return Combine(points)
</pre><a href="#section-6.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="rvtss">
<section id="section-6.2">
        <h3 id="name-authenticated-threshold-sec">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-authenticated-threshold-sec" class="section-name selfRef">Authenticated Threshold Secret Sharing with Random Tags</a>
        </h3>
<p id="section-6.2-1">An authenticated threshold secret sharing scheme with random tags, denoted RVTSS, is parameterzed by a
prime-order group G and its scalar field F that implements the abstraction described in <a href="#dep-pog" class="auto internal xref">Section 3.2</a>.
The RVTSS scheme in this section is based on Pedersen's scheme from <span>[<a href="#Pedersen" class="cite xref">Pedersen</a>]</span>. In particular,
using G and F, the RandomShare, Share, and Recover functions are implemented as follows.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2-2">
<pre>
def Share(k, secret, rand, x):
  context = SetupSplitter(mode_basic, secret, rand, threshold)

  value = context.Split(id)
  commitment = context.RandomCommitment(id, poly)

  # Construct the share
  id_enc = G.SerializeScalar(id)
  value_enc = G.SerializeScalar(value)
  commitment_enc = SerializeRandomCommitment(commitment)
  share = id_enc || value_enc || commitment_enc

  return share

def RandomShare(k, secret, rand):
  # Evaluate the polynomial at a random point
  x = F.RandomScalar()
  return Share(k, secret, rand, x)

def Recover(k, share_set):
  if share_set.length &lt; k:
    raise RecoveryFailedError

  points = []
  for share in share_set:
    if Verify(share) == 0:
      raise "invalid share"
    x = F.DeserializeScalar(share[0:SCALAR_SIZE])
    y = F.DeserializeScalar(share[SCALAR_SIZE:2*SCALAR_SIZE])
    points.append((x, y))

  return Combine(points)
</pre><a href="#section-6.2-2" class="pilcrow">¶</a>
</div>
<p id="section-6.2-3">Verify is implemented as follows.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2-4">
<pre>
def Verify(share):
  id = G.DeserializeScalar(share[0:SCALAR_SIZE])
  value = G.DeserializeScalar(share[SCALAR_SIZE:2*SCALAR_SIZE])
  commitment_enc = share[2*SCALAR_SIZE:]

  commitments = DeserializeRandomCommitment(commitment_enc)

  return VerifyRandomCommitment(id, value, commitments)
</pre><a href="#section-6.2-4" class="pilcrow">¶</a>
</div>
<p id="section-6.2-5">Finally, ShareCommitment is implemented as follows.<a href="#section-6.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2-6">
<pre>
def ShareCommitment(share):
  commitment = share[2*SCALAR_SIZE:]
  return commitment
</pre><a href="#section-6.2-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="dvtss">
<section id="section-6.3">
        <h3 id="name-authenticated-threshold-secr">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-authenticated-threshold-secr" class="section-name selfRef">Authenticated Threshold Secret Sharing with Deterministic Tags</a>
        </h3>
<p id="section-6.3-1">An authenticated threshold secret sharing scheme with deterministic tags, denoted DVTSS, is parameterzed by a
prime-order group G and its scalar field F that implements the abstraction described in <a href="#dep-pog" class="auto internal xref">Section 3.2</a>.
The DVTSS scheme in this section is based on Feldman's scheme from <span>[<a href="#Feldman" class="cite xref">Feldman</a>]</span>. In particular,
using G and F, the RandomShare, Share, and Recover functions are implemented as follows.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3-2">
<pre>
def Share(k, secret, rand, x):
  context = SetupSplitter(mode_basic, secret, rand, threshold)

  value = context.Split(id)
  commitment = context.DeterministicCommitment(id, poly)

  # Construct the share
  id_enc = G.SerializeScalar(id)
  value_enc = G.SerializeScalar(value)
  commitment_enc = SerializeDeterministicCommitment(commitment)
  share = id_enc || value_enc || commitment_enc

  return share

def RandomShare(k, secret, rand):
  # Evaluate the polynomial at a random point
  x = F.RandomScalar()
  return Share(k, secret, rand, x)

def Recover(k, share_set):
  if share_set.length &lt; k:
    raise RecoveryFailedError

  points = []
  for share in share_set:
    if VerifyShare(share) == 0:
      raise "invalid share"
    x = F.DeserializeScalar(share[0:SCALAR_SIZE])
    y = F.DeserializeScalar(share[SCALAR_SIZE:2*SCALAR_SIZE])
    points.append((x, y))

  return Combine(points)
</pre><a href="#section-6.3-2" class="pilcrow">¶</a>
</div>
<p id="section-6.3-3">Verify is implemented as follows.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3-4">
<pre>
def Verify(share):
  id = G.DeserializeScalar(share[0:SCALAR_SIZE])
  value = G.DeserializeScalar(share[SCALAR_SIZE:2*SCALAR_SIZE])
  commitment_enc = share[2*SCALAR_SIZE:]

  commitments = DeserializeDeterministicCommitment(commitment_enc)

  return VerifyDeterministicShare(id, value, commitments)
</pre><a href="#section-6.3-4" class="pilcrow">¶</a>
</div>
<p id="section-6.3-5">Finally, ShareCommitment is implemented as follows.<a href="#section-6.3-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3-6">
<pre>
def ShareCommitment(share):
  commitment = share[2*SCALAR_SIZE:]
  return commitment
</pre><a href="#section-6.3-6" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="random-scalar">
<section id="section-7">
      <h2 id="name-random-scalar-generation">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-random-scalar-generation" class="section-name selfRef">Random Scalar Generation</a>
      </h2>
<p id="section-7-1">Two popular algorithms for generating a random integer uniformly distributed in
the range [0, G.Order() -1] are as follows:<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="rejection-sampling">
<section id="section-7.1">
        <h3 id="name-rejection-sampling">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-rejection-sampling" class="section-name selfRef">Rejection Sampling</a>
        </h3>
<p id="section-7.1-1">Generate a random byte array with <code>Ns</code> bytes, and attempt to map to a Scalar
by calling <code>DeserializeScalar</code> in constant time. If it succeeds, return the
result. If it fails, try again with another random byte array, until the
procedure succeeds. Failure to implement <code>DeserializeScalar</code> in constant time
can leak information about the underlying corresponding Scalar.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">As an optimization, if the group order is very close to a power of
2, it is acceptable to omit the rejection test completely.  In
particular, if the group order is p, and there is an integer b
such that <code>p - 2&lt;sup&gt;b&lt;/sup&gt;| &lt; 2&lt;sup&gt;(b/2)&lt;/sup&gt;</code>, then
<code>RandomScalar</code> can simply return a uniformly random integer of at
most b bits.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="wide-reduction">
<section id="section-7.2">
        <h3 id="name-wide-reduction">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-wide-reduction" class="section-name selfRef">Wide Reduction</a>
        </h3>
<p id="section-7.2-1">Generate a random byte array with <code>l = ceil(((3 * ceil(log2(G.Order()))) / 2) / 8)</code>
bytes, and interpret it as an integer; reduce the integer modulo <code>G.Order()</code> and return the
result. See <span><a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-16#section-5" class="relref">Section 5</a> of [<a href="#HASH-TO-CURVE" class="cite xref">HASH-TO-CURVE</a>]</span> for the underlying derivation of <code>l</code>.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1">The fundamental property of each TSS scheme is that it satisfies a notion of privacy, meaning
that individual shares reveal nothing unless the specified threshold number of shares are combined
to recover the secret. A VTSS scheme adds an additional property called verifiability, which allows
the aggregator to check that each share is correct. A VTSS scheme also lets the aggregator implement
recovery such that combination of valid shares with the same commitment succeeds with overwhelming
probability.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">TODO: add more security consideration discussion<a href="#section-8-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-9-1">This document has no IANA actions.<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="ADSS">[ADSS]</dt>
        <dd>
<span class="refAuthor">Bellare, M.</span>, <span class="refAuthor">Dai, W.</span>, and <span class="refAuthor">P. Rogaway</span>, <span class="refTitle">"Reimagining Secret Sharing: Creating a Safer and More Versatile Primitive by Adding Authenticity, Correcting Errors, and Reducing Randomness Requirements"</span>, <span class="seriesInfo">Proceedings on Privacy Enhancing Technologies vol. 2020, no. 4, pp. 461-490</span>, <span class="seriesInfo">DOI 10.2478/popets-2020-0082</span>, <time datetime="2020-08" class="refDate">August 2020</time>, <span>&lt;<a href="https://doi.org/10.2478/popets-2020-0082">https://doi.org/10.2478/popets-2020-0082</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Feldman">[Feldman]</dt>
        <dd>
<span class="refAuthor">Feldman, P.</span>, <span class="refTitle">"A practical scheme for non-interactive verifiable secret sharing"</span>, <span class="seriesInfo">28th Annual Symposium on Foundations of Computer Science (sfcs 1987)</span>, <span class="seriesInfo">DOI 10.1109/sfcs.1987.4</span>, <time datetime="1987-10" class="refDate">October 1987</time>, <span>&lt;<a href="https://doi.org/10.1109/sfcs.1987.4">https://doi.org/10.1109/sfcs.1987.4</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="HASH-TO-CURVE">[HASH-TO-CURVE]</dt>
        <dd>
<span class="refAuthor">Faz-Hernandez, A.</span>, <span class="refAuthor">Scott, S.</span>, <span class="refAuthor">Sullivan, N.</span>, <span class="refAuthor">Wahby, R. S.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Hashing to Elliptic Curves"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-hash-to-curve-16</span>, <time datetime="2022-06-15" class="refDate">15 June 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-16">https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-16</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Pedersen">[Pedersen]</dt>
        <dd>
<span class="refAuthor">Pedersen, T.</span>, <span class="refTitle">"Non-Interactive and Information-Theoretic Secure Verifiable Secret Sharing"</span>, <span class="seriesInfo">Advances in Cryptology - CRYPTO '91 pp. 129-140</span>, <span class="seriesInfo">DOI 10.1007/3-540-46766-1_9</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://doi.org/10.1007/3-540-46766-1_9">https://doi.org/10.1007/3-540-46766-1_9</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4086">[RFC4086]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refAuthor">Schiller, J.</span>, and <span class="refAuthor">S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time datetime="2005-06" class="refDate">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4086">https://www.rfc-editor.org/rfc/rfc4086</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RISTRETTO">[RISTRETTO]</dt>
        <dd>
<span class="refAuthor">de Valence, H.</span>, <span class="refAuthor">Grigg, J.</span>, <span class="refAuthor">Hamburg, M.</span>, <span class="refAuthor">Lovecruft, I.</span>, <span class="refAuthor">Tankersley, G.</span>, and <span class="refAuthor">F. Valsorda</span>, <span class="refTitle">"The ristretto255 and decaf448 Groups"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-ristretto255-decaf448-04</span>, <time datetime="2022-10-14" class="refDate">14 October 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-ristretto255-decaf448-04">https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-ristretto255-decaf448-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ShamirSecretSharing">[ShamirSecretSharing]</dt>
      <dd>
<span class="refAuthor">Shamir, A.</span>, <span class="refTitle">"How to share a secret"</span>, <span class="seriesInfo">Communications of the ACM vol. 22, no. 11, pp. 612-613</span>, <span class="seriesInfo">DOI 10.1145/359168.359176</span>, <time datetime="1979-11" class="refDate">November 1979</time>, <span>&lt;<a href="https://doi.org/10.1145/359168.359176">https://doi.org/10.1145/359168.359176</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="test-vectors">
<section id="appendix-A">
      <h2 id="name-test-vectors">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-test-vectors" class="section-name selfRef">Test Vectors</a>
      </h2>
<p id="appendix-A-1">This section contains test vectors for the TSS and VTSS schemes specified in this
document. All <code>Element</code> and <code>Scalar</code> values are represented in serialized form and
encoded in hexadecimal strings. The secret and randomness inputs to the scheme is
also encoded as a hexadecimal string. The threshold is an integer.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="tss-f64">
<section id="appendix-A.1">
        <h3 id="name-tss-f64">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-tss-f64" class="section-name selfRef">TSS-F64</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-A.1-1">
<pre>
k: 2
secret: 736563726574
randomness: 1e325dc577261c977ea0faa042202e1ff3b3ea913f6530b1a4b19b58b
ed31205
shares: 56a3270beed985df81b13a5388fa5e52,beb1de321d43cf0da058d206e642
3b9f,d9d903d1c76a850201aab431d37ae8f0
shared_secret: fc3a9e517170d3d3
</pre><a href="#appendix-A.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="tss-f128">
<section id="appendix-A.2">
        <h3 id="name-tss-f128">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-tss-f128" class="section-name selfRef">TSS-F128</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-A.2-1">
<pre>
k: 2
secret: 736563726574
randomness: 1e325dc577261c977ea0faa042202e1ff3b3ea913f6530b1a4b19b58b
ed31205
shares: fef4c962e1c956bacc957b5cedcd9d748039bc3adb5e8e1fec97bda00c444
62c,c27808d82207cca5ab6f0e20b790afaac3e34be725664badc43a093b4d493327,
6995a7a17e03fb0b8a4970c43b40d83500ad27f8fbe0da42bf1e8f92f072a9f3
shared_secret: 09d3b1b0f9be9f530d2cd11f0bda2cac
</pre><a href="#appendix-A.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="tss-f255">
<section id="appendix-A.3">
        <h3 id="name-tss-f255">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-tss-f255" class="section-name selfRef">TSS-F255</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-A.3-1">
<pre>
k: 2
secret: 736563726574
randomness: 1e325dc577261c977ea0faa042202e1ff3b3ea913f6530b1a4b19b58b
ed31205
shares: 814fd00076499894fdf3c06f8aedcfab15f3e76b52ef349c29b10a4d15ae0
51352999b4d14dcb1ef0e5620ebe0f23dbd1b8bb77b6cc74285aaa99e35716ec327,a
c7b6a997d2da53114ab01ac1fbf9b97ed0955ee0a9f227a9ee1195fb6415836361c18
cd2038a5aa755980ba4443e58fd6114807e6e4f57af0542a16cbf59815,8c5cc8412e
42b8ee80ce3fa1b96a88601e80abc943e5dcac49ee73bf12cd5d6e5d8d64198ea0804
0d3b1e5582f00b6ee7c1190f61af958fea94cbcdef39c3470
shared_secret: 8f1e2d14d4d00e83035c60183e081756d02e29ed2cc6894e79bf2c
8bde0e310e
</pre><a href="#appendix-A.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="dvtss-ristretto255">
<section id="appendix-A.4">
        <h3 id="name-dvtss-ristretto255">
<a href="#appendix-A.4" class="section-number selfRef">A.4. </a><a href="#name-dvtss-ristretto255" class="section-name selfRef">DVTSS-Ristretto255</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-A.4-1">
<pre>
k: 2
secret: 736563726574
randomness: a8db8264b6851cf3f945d1a5e6e17ef56b0570d235e43827ef81b3a98
0c3188a
shares: 43a380a9f0ddca73b64869fad8d9eb4b9ff4a669673a623416ef7d0afccc1
904082ae9339424b93a551ebbf7ce83b575b5de3572a9e29bcf0a357bd5a4ed810ba4
9955528f18cd06302513f9aa9be748618600fcdaef202b8583c2210bb7cb5928fd4f6
1e83d3f9c3ae0e38a1d2fb005c2a85a726f126078e701edbc5d9abc2e,48dad15cbd1
1c4c0e432580e75730bb1d9bdab11cfe818ca335a48d014ae1700af230ad59ff4d1f6
de4890f599a96803fd229bec835da9561d6bc247f6b8110ea49955528f18cd0630251
3f9aa9be748618600fcdaef202b8583c2210bb7cb5928fd4f61e83d3f9c3ae0e38a1d
2fb005c2a85a726f126078e701edbc5d9abc2e,1933bda2ed278bbfc3c3c47c248d67
0de560280b5c9934b6020ac704c316ae06629dbda78e9f1476552e6ea37e6759f8de4
16440643a5ddad0bfcd75a11b3606a49955528f18cd06302513f9aa9be748618600fc
daef202b8583c2210bb7cb5928fd4f61e83d3f9c3ae0e38a1d2fb005c2a85a726f126
078e701edbc5d9abc2e
shared_secret: edb875686b330f37883f51332cbdd80f38ab8d5bbeab332a1a0685
5a12394e0f
</pre><a href="#appendix-A.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="rvtss-ristretto255">
<section id="appendix-A.5">
        <h3 id="name-rvtss-ristretto255">
<a href="#appendix-A.5" class="section-number selfRef">A.5. </a><a href="#name-rvtss-ristretto255" class="section-name selfRef">RVTSS-Ristretto255</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-A.5-1">
<pre>
k: 2
secret: 736563726574
randomness: 2f6c33f327f3ddcadd29588d332a8470801928fe83983b2a192d06d81
f0c9b3d
shares: f20ae83b5215b90b416e11924a80920608ae8cfe6a06657ffc01c220cf004
200a1f6ca25d818965a7072cc4f63c322e2e1d82021aed7440c98fbe22278b5710bbd
4155cd1f89a9289691dadd9a0aac3d1c2f2963192c3aa4d5b54774b307a20f3231686
1dd8f2b41193a62dd9c8ab23803a341071ad1dcd4e939986ff335b247ac0e31f8c110
28db0d70637fdd98d6cc19855bad73dbfc8a5a1a0931059c745f,c125d9e4877d7179
dd78c62d0e095110b4a29bc309462cf223e2162a1da19f0ab038300634619cc355fe8
ce730206ece96fd7709902771d0785ab9ad1ffac708ffd66f17a114a0e8bc870d89bc
770ec688a9b58c81ed021546b89ab987ddc00e06fe5f6311c01faa1021b588967e186
cfa71c69202ff414be8570249f1a6b84edcb3d493b4172973a2a866d356e4dc8c1a4a
caa0c809a4a0fbf7f53d916fea26,131fdedb6cbf84844f713659e62f0876109cbe23
0f5418d8e26503d8c2022801c1ff583ec2e750e3d4c6a6a253c84802f6b7ad06a06f7
a077667e3d188f3af0f19531aec9468c253db4923e97a8160100da7f436c17c6594ce
604ef26c3ec10fbcbfeb75d57dad72778b58c16737ad493b0d1d803893e722974498b
74779ab4c18d2f73b4ee1213be3872f201419046e9df2cfbc547f2115a86958931144
e610
shared_secret: 80e702ce03d835247b31d32c8a87d03aa8212b69bf31568ab0df88
a82c4e8a0b
</pre><a href="#appendix-A.5-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-B">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-B-1">This document was written based on discussions in the Privacy Preserving Measurement Working Group.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Christopher A. Wood</span></div>
<div dir="auto" class="left"><span class="org">Cloudflare</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:caw@heapingbits.net" class="email">caw@heapingbits.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
